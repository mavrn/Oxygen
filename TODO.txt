free operators: $ ยง << =>> ==> <= =>)
#redo exceptions + add trycatch
#update comments

testcases to add
#getfield
#dicts
#kwargs
array.filter
#hashstrings


fn one => 
    x=0
    getscope().p
    return x
<<

fn plus_two =>
    getscope().p
    rep 1 =>
        getscope().p
    <<
    return one() + 2
<<

getscope().p
plus_two()


#https://www.codewars.com/kata/52742f58faf5485cae000b9a/train/python
fn filledvalues values =>
    filled = 0
    iter values as i =>
        if i => filled++
    <<
    return filled
<<

fn format_duration seconds =>
    if seconds == 0 => return "now"
    timeNames = ["year", "day", "hour", "minute", "second"]
    timeValues = [0]*5
    timeValues[0] = seconds//31536000
    seconds-=timeValues[0]* 31536000
    timeValues[1] = seconds//86400
    seconds-= timeValues[1]*86400
    timeValues[2] = seconds//3600
    seconds-= timeValues[2]*3600
    timeValues[3] = seconds//60
    seconds-= timeValues[3]*60
    timeValues[4] = seconds

    filled = filledvalues(timeValues)
    res = ""
    for i=0,i<5,i++ =>
        if timeValues[i] != 0 =>
            res += timeValues[i].s + " " + timeNames[i]
            if timeValues[i] > 1 => res += "s"
            filled--
            if filled > 1 => res += ", "
            if filled == 1 => res += " and "
        <<
    <<
    return res
<<
62.format_duration
3662.format_duration
33243586.format_duration

['1 minute and 2 seconds', '1 hour, 1 minute and 2 seconds', ''1 year, 19 days, 18 hours, 19 minutes and 46 seconds]